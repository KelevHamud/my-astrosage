<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Chinta Mani Pro ‚Äî –í–µ–¥–∏—á–µ—Å–∫–∏–π –ü–æ—Ä—Ç–∞–ª</title>
    <style>
        :root { --gold: #c5a059; --dark: #1a1a1b; --card: #252627; }
        body { background: var(--dark); color: #e0e0e0; font-family: 'Arial', sans-serif; padding: 20px; }
        .wrapper { max-width: 900px; margin: auto; }
        .grid-input { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; background: var(--card); padding: 25px; border-radius: 12px; border: 1px solid var(--gold); }
        input, button { padding: 12px; border-radius: 6px; border: 1px solid #444; background: #333; color: #fff; }
        button { background: var(--gold); color: #000; font-weight: bold; cursor: pointer; transition: 0.3s; border: none; }
        button:hover { background: #e2b86a; }
        
        /* –õ–æ-–®—É –ö–≤–∞–¥—Ä–∞—Ç */
        .lo-shu { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 300px; margin: 20px auto; }
        .cell { background: #333; height: 90px; border: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; font-size: 24px; position: relative; }
        .cell span { position: absolute; bottom: 5px; right: 5px; font-size: 10px; color: var(--gold); }
        .empty { color: #555; }

        .section { margin-top: 30px; background: var(--card); padding: 20px; border-radius: 10px; }
        .missing-box { border-left: 4px solid #f44336; padding-left: 15px; margin-top: 10px; }
        .chakra-tag { background: #444; padding: 5px 10px; border-radius: 20px; font-size: 13px; margin-right: 5px; }
    </style>
</head>
<body>

<div class="wrapper">
    <h1 style="text-align:center; color:var(--gold);">üïâÔ∏è CHINTA MANI PRO</h1>
    
    <div class="grid-input">
        <input type="text" id="name" placeholder="–ò–º—è">
        <input type="date" id="date">
        <input type="time" id="time" value="06:00">
        <input type="date" id="p_date" placeholder="–î–∞—Ç–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞">
        <button onclick="calculate()">–ü–û–õ–£–ß–ò–¢–¨ –ü–û–õ–ù–´–ô –†–ê–°–ß–ï–¢</button>
    </div>

    <div id="loading" style="display:none; text-align:center; margin:20px;">–ó–∞–ø—Ä–∞—à–∏–≤–∞—é —Ö—Ä–æ–Ω–∏–∫–∏ –ê–∫–∞—à–∏...</div>

    <div id="results" style="display:none;">
        <div class="section">
            <h2>–õ–∏—á–Ω–æ—Å—Ç—å: <span id="res-name"></span></h2>
            <p><strong>–ß–∏—Å–ª–æ –î—É—à–∏ (–ú—É–ª–∞–Ω–∫):</strong> <b id="res-mula"></b> (–ü–ª–∞–Ω–µ—Ç–∞: <span id="res-planet"></span>)</p>
            <p><strong>–ß–∏—Å–ª–æ –°—É–¥—å–±—ã (–ë—Ö–∞–≥—å—è–Ω–∫):</strong> <b id="res-bhagya"></b></p>
            <p><strong>–ß–∏—Å–ª–æ –ò–º–µ–Ω–∏:</strong> <b id="res-nama"></b></p>
            <p><i>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞: <span id="res-planet-desc"></span></i></p>
        </div>

        <div class="section">
            <h3 style="text-align:center;">–ö–≤–∞–¥—Ä–∞—Ç –õ–æ-–®—É</h3>
            <div class="lo-shu" id="lo-shu-grid"></div>
            <div id="missing-info"></div>
        </div>

        <div class="section">
            <h3>–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—Ç—Ä—ã (–ß–∞–∫—Ä—ã)</h3>
            <div id="chakra-data"></div>
        </div>

        <div class="section" id="comp-sec" style="display:none;">
            <h3>üíû –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</h3>
            <p id="comp-res"></p>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwFiqRdikGj2xpExzMRxin6piodIsf7c5UH1NTZ6AhCWS-2_XsPAPvz4HqGD0RVWqJo/exec';

    async function calculate() {
        document.getElementById('loading').style.display = 'block';
        const url = `${SCRIPT_URL}?name=${document.getElementById('name').value}&date=${document.getElementById('date').value}&time=${document.getElementById('time').value}&p_date=${document.getElementById('p_date').value}`;
        
        try {
            const response = await fetch(url);
            const d = await response.json();

            document.getElementById('res-name').innerText = d.user.name;
            document.getElementById('res-mula').innerText = d.user.mulank;
            document.getElementById('res-bhagya').innerText = d.user.bhagya;
            document.getElementById('res-nama').innerText = d.user.namank;
            document.getElementById('res-planet').innerText = d.planet.n;
            document.getElementById('res-planet-desc').innerText = d.planet.desc;

            // –õ–æ-–®—É
            const grid = document.getElementById('lo-shu-grid');
            grid.innerHTML = '';
            const order = [4,9,2,3,5,7,8,1,6];
            order.forEach(num => {
                let val = d.matrix[num] > 0 ? num.toString().repeat(d.matrix[num]) : '-';
                grid.innerHTML += `<div class="cell ${val==='-'?'empty':''}">${val}<span>${num}</span></div>`;
            });

            // –ü—É—Å—Ç–æ—Ç—ã
            const mInfo = document.getElementById('missing-info');
            mInfo.innerHTML = '<h4>–ö–∞—Ä–º–∏—á–µ—Å–∫–∏–µ –ø—É—Å—Ç–æ—Ç—ã:</h4>';
            d.missingNodes.forEach(node => {
                mInfo.innerHTML += `<div class="missing-box"><b>–ß–∏—Å–ª–æ ${node.num}:</b> ${node.text}</div>`;
            });

            // –ß–∞–∫—Ä—ã
            const chBox = document.getElementById('chakra-data');
            chBox.innerHTML = '';
            for(let key in d.chakras) {
                chBox.innerHTML += `<span class="chakra-tag">${key}: <b>${d.chakras[key]}</b></span>`;
            }

            // –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
            if(d.compatibility) {
                document.getElementById('comp-sec').style.display = 'block';
                document.getElementById('comp-res').innerText = d.compatibility.status;
            }

            document.getElementById('results').style.display = 'block';
        } catch (err) { alert("–û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö"); }
        document.getElementById('loading').style.display = 'none';
    }
</script>
</body>
</html>
